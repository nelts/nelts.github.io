<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é¡¹ç›®ç»“æ„ | Hello, World.</title>
    <meta name="description" content="ğŸ“¦ ğŸ¨ A api-friendly theme for VuePress.">
    
    
    <link rel="preload" href="/docs/assets/css/0.styles.82356fe1.css" as="style"><link rel="preload" href="/docs/assets/js/app.d76baf5b.js" as="script"><link rel="preload" href="/docs/assets/js/5.81314610.js" as="script"><link rel="prefetch" href="/docs/assets/js/2.616b53dd.js"><link rel="prefetch" href="/docs/assets/js/3.4ddc58d9.js"><link rel="prefetch" href="/docs/assets/js/4.6bef892f.js"><link rel="prefetch" href="/docs/assets/js/6.43a04369.js"><link rel="prefetch" href="/docs/assets/js/7.3b030e8a.js"><link rel="prefetch" href="/docs/assets/js/8.bb3c3e49.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.82356fe1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme__container sidebar-open"><div class="row"><div class="col-md-2"><div class="sidebar"><div class="group"><div class="group__title">home</div> <div class="group__body"><div class="group__category category"><div class="category__label"><a href="/docs/" class="router-link-active">Homepage</a></div></div>  </div></div><div class="group"><div class="group__title">get-started</div> <div class="group__body"><div class="group__category category"><div class="category__label"><a href="/docs/get-started/" class="router-link-active">ç®€ä»‹</a></div></div>  <div name="/get-started/dir.html" class="group__category category category--selected category--active"><div class="category__label"><a href="/docs/get-started/dir.html" class="router-link-exact-active router-link-active">é¡¹ç›®ç»“æ„</a></div> <div class="category__headers"><div class="category__header-item"><a href="/docs/get-started/dir.html#æ ¹ç›®å½•">æ ¹ç›®å½•</a></div></div><div class="category__headers"><div class="category__header-item"><a href="/docs/get-started/dir.html#srcç›®å½•">Srcç›®å½•</a></div></div></div><div name="/get-started/usage.html" class="group__category category"><div class="category__label"><a href="/docs/get-started/usage.html">å®‰è£…</a></div> <div class="category__headers"><div class="category__header-item"><a href="/docs/get-started/usage.html#ç¼–è¯‘æ‚¨çš„é¡¹ç›®">ç¼–è¯‘æ‚¨çš„é¡¹ç›®</a></div></div><div class="category__headers"><div class="category__header-item"><a href="/docs/get-started/usage.html#å‘å¸ƒ">å‘å¸ƒ</a></div></div></div></div></div><div class="group"><div class="group__title">primary</div> <div class="group__body"><div class="group__category category"><div class="category__label"><a href="/docs/primary/">ç›®å½•</a></div></div>  </div></div></div></div> <div class="col-md-10"><div class="page__container"><div class="content custom"><h1 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" aria-hidden="true" class="header-anchor">#</a> é¡¹ç›®ç»“æ„</h1> <p>è¿™é‡Œæˆ‘ä»¬å°†åªå¯¹è„šæ‰‹æ¶ç”Ÿæˆçš„é¡¹ç›®è¿›è¡Œæè¿°ã€‚</p> <blockquote><p>è¿™é‡Œéœ€è¦ç†è§£ä¸€ä¸ªç‚¹ï¼Œæ¯ä¸ªé¡¹ç›®å¯ä»¥çœ‹ä½œä¸€ä¸ªæ’ä»¶ï¼Œæ‰€ä»¥é¡¹ç›®å³æ’ä»¶ï¼Œæ’ä»¶å³é¡¹ç›®ã€‚å®ƒå¯ä»¥è‡ªå¯åŠ¨ä¹Ÿå¯ä»¥å¤šèšåˆä¾èµ–å¯åŠ¨ã€‚</p></blockquote> <h2 id="æ ¹ç›®å½•"><a href="#æ ¹ç›®å½•" aria-hidden="true" class="header-anchor">#</a> æ ¹ç›®å½•</h2> <ul><li><code>dist/</code> æœ€ç»ˆç¼–è¯‘æ–‡ä»¶ç›®å½•</li> <li><code>src/</code> æ’ä»¶æºæ–‡ä»¶ç›®å½•</li> <li><code>logger.configure.js</code> æ—¥å¿—é…ç½®æ–‡ä»¶</li> <li><code>.gitignore</code></li> <li><code>package-lock.json</code></li> <li><code>package.json</code> æ’ä»¶æè¿°æ–‡ä»¶</li> <li><code>README.md</code> æè¿°æ–‡æ¡£</li> <li><code>tsconfig.json</code> TS é…ç½®æ–‡ä»¶</li></ul> <p><code>logger.configure.js</code>ä¸ºæ—¥å¿—é…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬é‡‡ç”¨ <a href="https://www.npmjs.com/package/log4js" target="_blank" rel="noopener noreferrer">log4js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä½œä¸ºæˆ‘ä»¬çš„æ—¥å¿—å¤„ç†æ¨¡å—ã€‚æ­¤æ–‡ä»¶å°±æ˜¯ç”¨æ¥é…ç½® <code>log4js</code>ã€‚ç”¨æ³•è¯·çœ‹<a href="https://github.com/log4js-node/log4js-node#documentation" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p><code>package.json</code>æ–‡ä»¶æ¯”è¾ƒç‰¹æ®Šï¼Œæˆ‘ä»¬é¢å¤–å¢åŠ äº†ä»¥ä¸‹çš„å±æ€§å­—æ®µï¼š</p> <ul><li><code>source: 'dist' | 'src'</code> å¯¹æ’ä»¶è¾“å‡ºè°ƒç”¨æ–‡ä»¶çš„æ–‡ä»¶å¤¹æè¿°ï¼Œä¸€èˆ¬åœ¨å¼€å‘è°ƒè¯•æœŸé—´ï¼Œè¿™é‡Œè®¾å®šçš„å€¼ä¸º<code>src</code>ï¼Œè€Œå½“ç¼–è¯‘åï¼Œè¿™é‡Œåº”è¯¥è®¾ç½®ä¸º<code>dist</code>ã€‚æ’ä»¶é»˜è®¤ <code>dist</code>ï¼Œæ‰€ä»¥åœ¨å¼€å‘çš„æ—¶å€™ç†åº”æ”¹ä¸º<code>src</code>ã€‚</li> <li><code>plugin: { [package name]: package }</code> è¿™é‡ŒæŒ‡å®šæœ¬æ’ä»¶ä¾èµ–çš„è‡ªæ’ä»¶åˆ—è¡¨ã€‚</li></ul> <p>æ³¨æ„ <code>plugin</code> å­—æ®µç»“æ„æ˜¯è¿™æ ·çš„</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>type plugin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>options<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    enable<span class="token operator">?</span><span class="token punctuation">:</span> boolean<span class="token punctuation">,</span>
    env<span class="token operator">?</span><span class="token punctuation">:</span> string <span class="token operator">|</span> Array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    worker<span class="token operator">?</span><span class="token punctuation">:</span> boolean<span class="token punctuation">,</span>
    agent<span class="token operator">?</span><span class="token punctuation">:</span> string <span class="token operator">|</span> Array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token keyword">package</span><span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">,</span>
    path<span class="token operator">?</span><span class="token punctuation">:</span> string
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>[options].enable</code> è¡¨ç¤ºæ˜¯å¦å¯åŠ¨æ’ä»¶ï¼Œé»˜è®¤<code>undefined</code>å¯åŠ¨ã€‚</li> <li><code>[options].env</code> è¡¨ç¤ºæ’ä»¶è¿è¡Œçš„ç¯å¢ƒï¼Œç¯å¢ƒä¸€èˆ¬æŒ‡<code>process.env.NODE_ENV</code>ç¯å¢ƒï¼Œé»˜è®¤<code>undefined</code>ï¼Œå¯åœ¨ä»»æ„ç¯å¢ƒä¸Šè¿è¡Œã€‚å½“æŒ‡å®šç‰¹å®šç¯å¢ƒï¼Œé‚£ä¹ˆè¯¥æ’ä»¶åªåœ¨æ­¤ç¯å¢ƒä¸­æ‰§è¡Œã€‚</li> <li><code>[options].worker</code> è¡¨ç¤ºæ˜¯å¦åœ¨workerè¿›ç¨‹ä¸Šå¯åŠ¨ï¼Œå³åœ¨æœåŠ¡è¿›ç¨‹ä¸Šå¯åŠ¨ã€‚</li> <li><code>[options].agent</code> è¡¨ç¤ºåœ¨å“ªä¸ªagentè¿›ç¨‹ä¸Šå¯åŠ¨ã€‚</li> <li><code>[options].package</code> è¡¨ç¤ºè¿™ä¸ªä¾èµ–æ’ä»¶çš„æ¨¡å—åŒ…åï¼Œä¸€èˆ¬ç”¨äºç”Ÿæˆï¼Œå®ƒä¸<code>path</code>äº’æ–¥ï¼Œä¼˜å…ˆçº§ç•¥ä½ã€‚</li> <li><code>[options].path</code> è¡¨ç¤ºè¿™ä¸ªä¾èµ–æ’ä»¶çš„ç›®å½•ï¼Œä¸€èˆ¬ç”¨äºå¼€å‘ï¼Œå®ƒä¸<code>package</code>äº’æ–¥ï¼Œä¼˜å…ˆçº§ç•¥é«˜ã€‚</li></ul> <h2 id="srcç›®å½•"><a href="#srcç›®å½•" aria-hidden="true" class="header-anchor">#</a> srcç›®å½•</h2> <p>ä¸€èˆ¬ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹çš„ç›®å½•ç»“æ„</p> <ul><li><code>src/nelts.config.ts</code> é…ç½®æ–‡ä»¶</li> <li><code>src/controller</code> Controllerå±‚æ–‡ä»¶å­˜æ”¾å¤„ã€‚è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶å°†è¢«è‡ªåŠ¨loaderåæ³¨å…¥è·¯ç”±åˆ°æœåŠ¡ä¸­ã€‚</li> <li><code>src/middleware</code> Middlewareå±‚æ–‡ä»¶å­˜æ”¾å¤„ã€‚è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶å°†è‡ªåŠ¨loaderåæ³¨å…¥åˆ°æ’ä»¶å¯¹è±¡ä¸Šã€‚</li> <li><code>src/service</code> Serviceå±‚æ–‡ä»¶å­˜æ”¾å¤„ã€‚è¯¥ç›®å½•ä¸‹æ–‡ä»¶å°†è‡ªåŠ¨loaderåæ³¨å…¥åˆ°æ’ä»¶å¯¹è±¡ä¸Šã€‚</li> <li><code>src/agent</code> Agentsè¾…åŠ©è¿›ç¨‹ç›®å½•</li> <li><code>app.ts</code> æ’ä»¶æœåŠ¡å¯åŠ¨åˆå§‹åŒ–æ–‡ä»¶ã€‚</li></ul> <h3 id="src-controller"><a href="#src-controller" aria-hidden="true" class="header-anchor">#</a> src/controller</h3> <p>Controlleråœ¨è¿™é‡Œè¢«è®¾è®¡ä¸ºAOPç¼–ç¨‹ï¼Œç”¨äºç®€åŒ–è·¯ç”±è®¾å®šå’Œå…¶ä»–å„ç§ä¸­é—´ä»¶åµŒå…¥ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/index.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Decorator<span class="token punctuation">,</span> WorkerPlugin<span class="token punctuation">,</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nelts/nelts'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Controller <span class="token operator">=</span> Decorator<span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

@Controller<span class="token punctuation">.</span><span class="token function">Prefix</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Component<span class="token punctuation">.</span>Controller</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token punctuation">:</span> WorkerPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @Controller<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">'/hello'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">Home</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'hello world'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å½“æˆ‘ä»¬è®¿é—®<code>/api/hello</code>è·¯ç”±ï¼Œé¡µé¢å°†çœ‹åˆ° <code>hello world</code> ã€‚</p> <h3 id="src-middleware"><a href="#src-middleware" aria-hidden="true" class="header-anchor">#</a> src/middleware</h3> <p>Middlewareä¸­é—´ä»¶ï¼Œç±»ä¼¼<code>KOA</code>çš„ä¸­é—´ä»¶ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nelts/nelts'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">LoggerError</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">,</span> next<span class="token punctuation">:</span> Function<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">:</span> Error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="src-service"><a href="#src-service" aria-hidden="true" class="header-anchor">#</a> src/service</h3> <p>Serviceæ‰æ˜¯å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å¤„ç†æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨Controllerå±‚ä¸Šè°ƒç”¨serviceä¸‹çš„æ–‡ä»¶æ¥è°ƒç”¨é‡Œé¢çš„æ–¹æ³•ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> <span class="token constant">NELTS_CONFIGS</span><span class="token punctuation">,</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nelts/nelts'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">SumService</span> <span class="token keyword">extends</span> <span class="token class-name">Component<span class="token punctuation">.</span>Service</span><span class="token operator">&lt;</span>Context<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> configs<span class="token punctuation">:</span> <span class="token constant">NELTS_CONFIGS</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> NPMContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>configs <span class="token operator">=</span> ctx<span class="token punctuation">.</span>app<span class="token punctuation">.</span>configs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> number<span class="token punctuation">,</span> b<span class="token punctuation">:</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥åœ¨Controllerä¸Šè¿™æ ·è°ƒç”¨</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Decorator<span class="token punctuation">,</span> WorkerPlugin<span class="token punctuation">,</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nelts/nelts'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Controller <span class="token operator">=</span> Decorator<span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

@Controller<span class="token punctuation">.</span><span class="token function">Prefix</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Component<span class="token punctuation">.</span>Controller</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token punctuation">:</span> WorkerPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @Controller<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">'/hello'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">Home</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> SumService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>service<span class="token punctuation">.</span>SumService</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
      total<span class="token punctuation">:</span> SumService<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨é¡µé¢<code>get:/api/hello</code>ä¸Šèƒ½å¤Ÿçœ‹åˆ° <code>{ total: 7 }</code>ã€‚</p> <h3 id="src-agent"><a href="#src-agent" aria-hidden="true" class="header-anchor">#</a> src/agent</h3> <p>agentç›®å½•å°†è‡ªåŠ¨æˆ–è€…æ‰‹åŠ¨å¯åŠ¨è¾…åŠ©è¿›ç¨‹ï¼Œå®ƒçš„ä»£ç æ ¼å¼å¦‚ä¸‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> AgentApplciation<span class="token punctuation">,</span> Decorator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nelts/nelts'</span><span class="token punctuation">;</span>

@Decorator<span class="token punctuation">.</span>Auto
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">CloudCompilerGateWay</span> <span class="token keyword">extends</span> <span class="token class-name">Component<span class="token punctuation">.</span>Agent</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> compilers<span class="token punctuation">:</span> Compilers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>app<span class="token punctuation">:</span> AgentApplciation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// IPCäº¤äº’æ–¹æ³•</span>
  @Decorator<span class="token punctuation">.</span>Ipc
  @Decorator<span class="token punctuation">.</span>Feedback
  <span class="token function">project</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> dictionary<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>compilers<span class="token punctuation">[</span>data<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'cannot find the compiler name of '</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>compilers<span class="token punctuation">[</span>data<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>dictionary <span class="token operator">=</span> data<span class="token punctuation">.</span>dictionary<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>@Decorator.Auto</code> è‡ªåŠ¨å¯åŠ¨æœåŠ¡è¿›ç¨‹ã€‚ä¸å†™åˆ™éœ€è¦æ‰‹åŠ¨å¯åŠ¨</li> <li><code>@Decorator.Ipc</code> æ ‡è®°æ­¤æ–¹æ³•æ˜¯ä¸€ä¸ªIPCé€šè®¯æ–¹æ³•</li> <li><code>@Decorator.Feedback</code> æ ‡è®°æ­¤æ–¹æ³•éœ€è¦å“åº”</li></ul> <h3 id="src-app-ts"><a href="#src-app-ts" aria-hidden="true" class="header-anchor">#</a> src/app.ts</h3> <p>åˆå§‹åŒ–æ–‡ä»¶ã€‚å®ƒä¸»è¦è¢«ç”¨æ¥å¤„ç†<code>props</code>å‚æ•°æ³¨å…¥å’Œç”Ÿå‘½å‘¨æœŸçš„ç»Ÿä¸€æ‹¦æˆªã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> WorkerPlugin<span class="token punctuation">,</span> ContextError<span class="token punctuation">,</span> Context <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nelts/nelts'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>plu<span class="token punctuation">:</span> WorkerPlugin<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ServerStarted'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts life [ServerStarted] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ServerStopping'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts life [ServerStopping] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ServerStopped'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts life [ServerStopped] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextStaticValidator'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextStaticValidator] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextStaticFilter'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextStaticFilter] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextDynamicLoader'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextDynamicLoader] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextDynamicValidator'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextDynamicValidator] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextDynamicFilter'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextDynamicFilter] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextGuard'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextGuard] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextMiddleware'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextMiddleware] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextRuntime'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextRuntime] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextResponse'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life [ContextResponse] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextResolve'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life status [ContextResolve] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextReject'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">:</span> Error<span class="token punctuation">,</span> ctx<span class="token punctuation">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nelts context life status [ContextReject] invoked.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// å‘å­ä¾èµ–æ³¨å…¥å‚æ•°</span>
  plu<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'props'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> configs <span class="token operator">=&gt;</span> <span class="token keyword">await</span> plu<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token string">'@nelts/orm'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    sequelize<span class="token punctuation">:</span> configs<span class="token punctuation">.</span>sequelize<span class="token punctuation">,</span>
    redis<span class="token punctuation">:</span> configs<span class="token punctuation">.</span>redis<span class="token punctuation">,</span>
    redis_prefix<span class="token punctuation">:</span> configs<span class="token punctuation">.</span>redis_prefix<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// è¯·æ±‚çº§åˆ«é”™è¯¯å®¹é”™å¤„ç†</span>
  plu<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ContextStart'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> NPMContext<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">:</span> ContextError<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> err<span class="token punctuation">.</span>status <span class="token operator">||</span> <span class="token number">422</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        status<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span>status<span class="token punctuation">,</span>
        error<span class="token punctuation">:</span> err<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// è¾…åŠ©è¯·æ±‚æ‹¦æˆªäº‹ä»¶</span>
  plu<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">` - [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">] inComingRequest:`</span></span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="content__footer-container"><div class="content__footer"><!----> <!----></div></div></div></div></div></div></div>
    <script src="/docs/assets/js/app.d76baf5b.js" defer></script><script src="/docs/assets/js/5.81314610.js" defer></script>
  </body>
</html>
